---
name: Implement leaveCircle and removeMember mutations
status: open
created: 2026-02-10T18:05:11Z
updated: 2026-02-10T18:15:11Z
github: https://github.com/SecondSaturday/second-saturday/issues/52
depends_on: [51]
parallel: false
conflicts_with: [51, 53]
---

# Task: Implement leaveCircle and removeMember mutations

## Description
Add `leaveCircle` and `removeMember` mutations to `convex/memberships.ts`. `leaveCircle` sets `leftAt` on the caller's membership. `removeMember` is admin-only and supports two modes: keep contributions (just sets `leftAt`) or remove & block (sets `leftAt`, `blocked: true`, and replaces contributions with "[Removed]").

## Acceptance Criteria
- [ ] `leaveCircle` mutation sets `leftAt` on caller's membership
- [ ] `leaveCircle` prevents admin from leaving without transferring admin role
- [ ] `removeMember` mutation is admin-only (uses `requireAdmin`)
- [ ] `removeMember` with `keepContributions: true` sets `leftAt` only
- [ ] `removeMember` with `keepContributions: false` sets `leftAt`, `blocked: true`
- [ ] Blocked member's contributions handling is stubbed (content tables don't exist yet)
- [ ] Removed member's current-cycle draft is discarded (stub for future)
- [ ] Both mutations validate the target member exists and is active

## Technical Details
- Files: `convex/memberships.ts`
- Use existing `requireAdmin` and `requireMembership` patterns from `circles.ts`
- Admin leave: throw error "Transfer admin role before leaving" (transfer mutation is P2, not in this epic)
- Contribution deletion will be a no-op stub until Epic 4 content tables exist

## Dependencies
- [ ] Task 51: Schema must have `leftAt` and `blocked` fields

## Effort Estimate
- Size: S
- Hours: 2
- Parallel: false (depends on 51)

## Definition of Done
- [ ] Code implemented
- [ ] Tests written and passing
- [ ] Edge cases handled (already left, not a member, self-removal)
