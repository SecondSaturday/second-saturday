---
name: Write tests for membership mutations and UI flows
status: closed
created: 2026-02-10T18:05:11Z
updated: 2026-02-11T11:35:08Z
github: https://github.com/SecondSaturday/second-saturday/issues/56
depends_on: [51, 52, 53, 57, 62, 63, 54]
parallel: false
conflicts_with: []
---

# Task: Write tests for membership mutations and UI flows

## Description
Write comprehensive tests for all membership functionality: Convex mutations/queries (unit/integration) and UI component tests. Target 80%+ coverage for business logic.

## Acceptance Criteria
- [ ] Unit tests for `leaveCircle` mutation (sets leftAt, prevents admin leave)
- [ ] Unit tests for `removeMember` mutation (keep vs block, admin-only)
- [ ] Unit tests for `joinCircle` rejoin logic (clears leftAt, rejects blocked)
- [ ] Unit tests for `getCircleMembers` (filters inactive)
- [ ] Unit tests for `getSubmissionStatus` (admin-only access)
- [ ] Component tests for InvitePreview (logged in, logged out, already member)
- [ ] Component tests for MemberList (sorting, admin badge)
- [ ] Component tests for LeaveCircleModal and RemoveMemberModal
- [ ] 80%+ coverage for membership business logic
- [ ] All tests pass

## Technical Details
- Files: `convex/__tests__/memberships.test.ts`, `src/__tests__/membership-components.test.tsx`
- Use Vitest + Testing Library (follow existing test patterns)
- Test edge cases: double leave, remove self, rejoin while blocked, invalid circle

## Dependencies
- [ ] All implementation tasks (51-54) must be complete

## Effort Estimate
- Size: M
- Hours: 4
- Parallel: false (needs all implementations done)

## Definition of Done
- [ ] Tests written and passing
- [ ] 80%+ coverage for business logic
- [ ] No flaky tests
