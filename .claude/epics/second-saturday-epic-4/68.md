---
name: Build photo upload with Capacitor Camera and compression
status: open
created: 2026-02-11T14:26:53Z
updated: 2026-02-11T14:34:25Z
github: https://github.com/SecondSaturday/second-saturday/issues/68
depends_on: [66]
parallel: false
conflicts_with: [69]
---

# Task: Build photo upload with Capacitor Camera and compression

## Description
Implement photo upload functionality using Capacitor Camera plugin for mobile camera/gallery access, with client-side image compression to reduce file sizes before uploading to Convex storage.

## Acceptance Criteria
- [ ] @capacitor/camera plugin installed and configured
- [ ] browser-image-compression library integrated
- [ ] MediaUploader component supports photo selection (camera + gallery)
- [ ] Photos compress to <200KB client-side (target max 1200px width)
- [ ] Compressed photos upload to Convex storage
- [ ] Upload progress indicator shown
- [ ] Successfully uploaded photos stored in media table
- [ ] Works on iOS and Android devices
- [ ] Error handling for failed uploads/compression
- [ ] User can cancel upload in progress

## Technical Details
- Component location: `src/components/submissions/MediaUploader.tsx`
- Use Capacitor Camera for native camera/gallery access
- Compression settings: maxSizeMB: 0.2, maxWidthOrHeight: 1200
- Upload to Convex storage via generateUploadUrl
- Store storageId in media table (linked to responseId)
- Support JPEG and PNG formats
- Show compression/upload progress
- Handle permissions (camera, photo library)

## Dependencies
- [ ] Task 002 (Backend schema) completed
- [ ] Capacitor Camera plugin configured in Epic 0
- [ ] Convex storage configured

## Effort Estimate
- Size: M
- Hours: 10-14
- Parallel: false (conflicts with video upload UI work)

## Definition of Done
- [ ] Photo upload working on web
- [ ] Photo upload working on iOS device
- [ ] Photo upload working on Android device
- [ ] Compression reduces file sizes correctly
- [ ] Upload completes in <5 seconds on typical mobile connection
- [ ] Unit tests written for compression logic
- [ ] E2E tests written for photo upload flow
- [ ] Code reviewed and merged
