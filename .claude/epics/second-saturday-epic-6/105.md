---
name: Integrate OneSignal SDK with Capacitor
status: open
created: 2026-02-22T05:54:13Z
updated: 2026-02-22T06:00:21Z
github: https://github.com/SecondSaturday/second-saturday/issues/105
depends_on: [102]
parallel: true
conflicts_with: []
---

# Task: Integrate OneSignal SDK with Capacitor

## Description
Initialize OneSignal SDK on app load using the existing Capacitor push notification plugins. Register the OneSignal player ID in the Convex users table. Handle push notification received and clicked events.

## Acceptance Criteria
- [ ] OneSignal SDK initialized on app load with app ID from environment
- [ ] Push notification permission requested on first launch (with graceful denial handling)
- [ ] OneSignal player ID stored in Convex users table via `registerOneSignalPlayerId` mutation
- [ ] Player ID updated if it changes (e.g., app reinstall)
- [ ] Push notification received handler works when app is in foreground
- [ ] Push notification clicked handler fires when user taps notification
- [ ] Graceful fallback when push permissions are denied (no crash, show settings prompt)

## Technical Details
- Packages already installed: `@awesome-cordova-plugins/onesignal`, `@capacitor/push-notifications`
- Create `src/lib/onesignal.ts` for SDK initialization and event handlers
- Initialize in app root (e.g., in a provider or layout component)
- Use Capacitor PushNotifications API for permission requests
- Store player ID after successful registration
- On notification click, extract data payload for deep linking (handled in Task 108)

## Dependencies
- [ ] Task 102 (oneSignalPlayerId field on users table)
- [ ] OneSignal account configured with FCM/APNs credentials
- [ ] ONESIGNAL_APP_ID environment variable set

## Effort Estimate
- Size: M
- Hours: 6
- Parallel: true (can run alongside Task 104)
