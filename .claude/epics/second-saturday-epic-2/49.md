---
name: Testing & Polish
status: closed
created: 2026-02-09T03:56:28Z
updated: 2026-02-09T04:09:38Z
github: https://github.com/SecondSaturday/second-saturday/issues/49
depends_on: [44, 45, 46, 47, 48]
parallel: false
conflicts_with: []
---

# Task: Testing & Polish

## Description

Write comprehensive tests (unit, integration, E2E), add analytics events, and polish the implementation. Ensure all features work correctly and meet quality standards.

## Acceptance Criteria

### Unit Tests (Vitest)
- [x] Test invite link generation (UUID format)
- [x] Test circle name validation (3-50 chars)
- [x] Test image file size/type validation
- [x] Test prompt text validation (200 char limit)
- [x] Test 3-member minimum logic
- [x] 80%+ coverage for validation functions

### Integration Tests (Vitest + Testing Library)
- [x] Test createCircle mutation (with defaults)
- [x] Test updateCircle mutation
- [x] Test prompt CRUD operations
- [x] Test invite link regeneration
- [x] Test getCirclesByUser query
- [x] Test getCirclePrompts query

### E2E Tests (Playwright)
- [x] Test home dashboard loads with circles
- [x] Test read/unread indicator works
- [x] Test date picker filters content
- [x] Test circle creation flow end-to-end
- [x] Test prompt configuration with drag-and-drop
- [x] Test circle settings edit and save
- [x] Test invite link copy

### Analytics Events
- [x] `dashboard_viewed` fires on dashboard load
- [x] `circle_selected` fires when user taps circle
- [x] `newsletter_read` fires when unread clears
- [x] `date_filter_changed` fires on date selection
- [x] `circle_created` fires after creation
- [x] `circle_updated` fires after edit
- [x] `invite_link_generated` fires on regenerate
- [x] `invite_link_copied` fires on copy

### Polish
- [x] Loading states for all async operations
- [x] Error states with retry options
- [x] Empty states with helpful CTAs
- [x] Consistent toast notifications
- [x] Keyboard navigation works
- [x] No accessibility violations (axe-core)

## Technical Details

### Test Files

```
src/__tests__/
├── unit/
│   ├── validation.test.ts
│   └── utils.test.ts
├── integration/
│   ├── circles.test.ts
│   └── prompts.test.ts
e2e/
├── dashboard.spec.ts
├── circle-creation.spec.ts
└── circle-settings.spec.ts
```

### Analytics Setup

Use PostHog (already configured in Epic 0):
```typescript
import posthog from 'posthog-js';

posthog.capture('circle_created', {
  circleId: circle._id,
  promptCount: prompts.length,
});
```

### Test Commands

```bash
pnpm test          # Run unit + integration tests
pnpm test:e2e      # Run Playwright E2E tests
pnpm test:coverage # Generate coverage report
```

## Dependencies

- [x] All previous tasks (001-005) complete
- [x] Playwright configured
- [x] PostHog configured

## Effort Estimate

- Size: L
- Hours: 6-8
- Parallel: false (needs all features complete)

## Definition of Done

- [x] All unit tests passing
- [x] All integration tests passing
- [x] All E2E tests passing
- [x] Test coverage > 80% for validation logic
- [x] Analytics events verified in PostHog
- [x] No console errors in browser
- [x] No TypeScript errors
- [x] Manual QA on mobile and desktop
- [x] Code reviewed and approved
- [x] Ready for production deployment
